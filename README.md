# kdca-covid19-upload
Python/Selenium 기반 오픈 소스 질병관리청 코로나19 검사 업로드 프로그램. 
## 사용 방법
1. 프로그램 다운로드

[![](http://img.youtube.com/vi/FfKvMNgEskc/0.jpg)](http://www.youtube.com/watch?v=FfKvMNgEskc "KDCA-covid19-upload 1. 프로그램 다운로드")

2. 데이터 수정

[![](http://img.youtube.com/vi/44g8N0fyJ68/0.jpg)](http://www.youtube.com/watch?v=44g8N0fyJ68 "KDCA-covid19-upload 2. 데이터 수정")

데이터 파일을 입력 프로그램의 양식에 맞게 수정하는 프로그램이다. 주소를 검색하여 올바른 형식으로 기입하고, 미기입 항목을 default 값으로 입력하거나 오류를 찾아내는 역할을 한다. 또한 전화번호와 주민등록 번호가 올바르게 입력되어 있는지를 확인한다. 수정된 데이터는 `파일 이름-refined.xlsx` 으로 저장된다.
 
데이터 수정 과정에서 발생한 오류는 자동으로 수정되거나, 혹은 `오류`행에 오류 메세지를 표시한다. 프로그램 입력 시 `오류` 행이 비어있지 않은(오류가 발생한) 열은 입력되지 않는다. 따라서 오류를 수정한 이후에는 `오류` 행의 정보를 삭제해야 입력이 정상적으로 이루어진다. 데이터의 즉각적인 수정이 불가능한 상황이면 `오류`를 삭제하지 않고 자동 입력 프로그램을 실행하는 것도 가능하다. 

3. 데이터 자동 입력

[![](http://img.youtube.com/vi/JqB9IKw1Auc/0.jpg)](http://www.youtube.com/watch?v=JqB9IKw1Auc "KDCA-covid19-upload 3. 데이터 자동입력")

자동으로 `covid19.kdca.go.kr` 에 데이터를 기입하는 프로그램이다. 파일 선택 이후 `데이터 입력` 버튼을 클릭하면 공인 인증서를 입력해야 한다. 입력 이후 다시 프로그램에서 버튼을 클릭하면 자동 입력이 시작된다. 입력에 실패한 검사자들의 목록은 `파일 이름-error.xlsx`에 저장된다. 

### 유의사항 
1. [이곳](https://www.whatismybrowser.com/detect/what-version-of-chrome-do-i-have) 에서 확인한 Chrome 브라우저 버전이 88.xx 이여야 한다.

1.1 버전이 일치하지 않는다면 [링크](https://chromedriver.chromium.org/downloads)에서 해당 브라우저의 버전에 맞는 chrome driver를 설치하고 압축해제 후 프로그램 폴더에 있는 기존의 chromedriver.exe와 교체한다.

1.2 혹은 88버전의 크롬을 설치한다. [다운그레이드 방법](https://support.google.com/chrome/a/answer/7125792?hl=en#zippy=%2Cstep-downgrade-chrome), [88버전 수동 설치](https://www.techspot.com/downloads/4718-google-chrome-for-windows.html)

2. Windows 운영체제에서 실행해야 한다. 
3. 입력 데이터는 반드시 입력 양식에 맞게 작성되어야 하며 오류 항목은 `데이터 수정` 이후 검사된다.

### 엑셀 입력 양식
##### 필수 기입 항목
필수 기입 항목은 반드시 입력해야 하는 항목으로 항목을 빈칸으로 두면 `오류` 행에 오류가 입력된다. 
필수 기입 항목:
 - 성명 
 - 주민등록번호
 - 성별
 - 휴대전화번호( 010xxxxxxxx/010-xxxx-xxxx/010 xxxx xxxx/10xxxxxxxx )의 꼴로 자유롭게 기입
 - 도로명주소: 자동으로 juso.or.kr을 통해 수정된다.
 - 진단의사
 - 검사결과
 - 직업: 아래의 직업표를 바탕으로 작성

##### 선택 기입 항목
선택 기입 항목은 선택적으로 입력하되, 미기입 시 default 값이 대신 입력된다. 
- 상세주소
- 외국인: 내국인->빈칸, 외국인->국가 이름을 입력
- 상세직업
- 증상및징후
- 발병일, 진단일, 신고일: yyyy mm dd의 형식으로 작성, `default: 0000 00 00`
- 입원여부: `default:외래`
- 환자분류: `default:그 밖의 경우(환자아님)`
- 비고(특이사항): `default: - `
- 소속기관(기관명, 주소...): 소속기관 존재시 다섯 항목 모두 기입해야 한다. 

해외 입국자 기입항목
- 추정감염지역:방문 국가명을 기입해주세요
- 체류기간, 입국일: yyyy mm dd의 형식으로, `default: 0000 00 00`

##### 번호 환산표
한글 문자에 상응하는 번호를 대신하여 기입할 수 있습니다, 
- 성별: 1:남 2:여
- **직업(직종 기입 혹은 상응하는 번호 기입)**
'의회의원,고위임직원 및 관리자':1
'전문가':2
'기술공 및 준전문가':3,
'사무종사자':4,
'서비스종사자':5,
'판매종사자':6,
'농업 및 어업숙련 종사자':7
'기능원 및 기능관련 종사자':8,
'장치,기계조작 및 조립종사자':9,
'단순노무 종사자':10,
'군인':11,
'(전업)주부':12, 
'학생':13, 
'무직':14, 
'기타':15
- 검사결과: 양성:1  음성:2  검사 진행중:3  검사 미실시:4
- 입원 여부:  입원:1  외래:2  그 밖의 경우:3
- 환자분류:  환자:1  의사환자:2   병원체보유자:3    그 밖의 경우(환자아님):4  검사 거부자:5     
